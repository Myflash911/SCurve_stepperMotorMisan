#define MAX 401


// using CNCshield & Arduino UNO

#define ENABLE 8
#define STEPY 3
#define DIRY  6


PROGMEM const double senoidal[] = {0,0.8339606223319053,0.9946382076625534,1.102915144710818,1.187087301995585,1.256985726887124,1.317307868080828,1.370698791711928,1.418808837054632,1.462743256670634,1.503281772696069,1.540996854329344,1.576322314637914,1.609595454999827,1.641084186801404,1.671005164425508,1.699536302697544,1.726825656288495,1.752997867901108,1.778158947543807,1.802399879006118,1.825799384967213,1.848426077328789,1.870340150906883,1.891594732895806,1.912236969354632,1.932308908333848,1.95184822399071,1.970888815099815,1.989461303414408,2.00759345148227,2.025310515162264,2.042635542806899,2.059589630581153,2.076192141472401,2.092460894062744,2.108412325976637,2.124061636005198,2.139422908185944,2.154509220540232,2.169332740707453,2.183904810340888,2.198236019825962,2.212336274633107,2.226214854413378,2.239880465776415,2.253341289550687,2.266605023209554,2.27967891904939,2.292569818624179,2.305284183872161,2.317828125311753,2.330207427634383,2.342427572979778,2.354493762143082,2.366410933932288,2.378183782867831,2.38981677539324,2.401314164745938,2.412680004619967,2.42391816173752,2.435032327433079,2.446026028342547,2.456902636279785,2.46766537737418,2.478317340535173,2.488861485302881,2.499300649137883,2.50963755419804,2.519874813645361,2.530014937521857,2.540060338229548,2.550013335646438,2.559876161907387,2.569650965876065,2.579339817331856,2.588944710893423,2.598467569698725,2.607910248859573,2.617274538707227,2.626562167844158,2.635774806015822,2.644914066815134,2.653981510231324,2.662978645053863,2.67190693114134,2.680767781564383,2.689562564630954,2.698292605801794,2.706959189503118,2.715563560843195,2.724106927238868,2.732590459957745,2.741015295581206,2.749382537393208,2.757693256699295,2.765948494080075,2.77414926058307,2.782296538856524,2.790391284228613,2.798434425735177,2.806426867098918,2.814369487662829,2.822263143280413,2.830108667165079,2.837906870700988,2.845658544217408,2.853364457728596,2.861025361641016,2.868641987429614,2.876215048284824,2.883745239731774,2.891233240223137,2.898679711707013,2.906085300171047,2.913450636164008,2.920776335295964,2.928062998718062,2.935311213582958,2.942521553486817,2.949694578893753,2.956830837543572,2.963930864843601,2.970995184245328,2.978024307606593,2.985018735539985,2.991978957748032,2.998905453345893,3.005798691171968,3.012659130087113,3.019487219262841,3.026283398459094,3.033048098291963,3.03978174049184,3.046484738152402,3.053157495970818,3.059800410479529,3.066413870270005,3.072998256208758,3.079553941645978,3.086081292617061,3.092580668037357,3.099052419890367,3.105496893409685,3.111914427254947,3.118305353681976,3.124669998707404,3.131008682267955,3.13732171837461,3.143609415261857,3.149872075532194,3.15610999629609,3.162323469307559,3.168512781095532,3.174678213091139,3.180820041751135,3.186938538677517,3.193033970733538,3.199106600156233,3.205156684665558,3.211184477570318,3.217190227870932,3.223174180359202,3.229136575715162,3.235077650601133,3.240997637753043,3.246896766069155,3.252775260696249,3.258633343113388,3.264471231213308,3.270289139381524,3.276087278573278,3.281865856388305,3.287625077143592,3.293365141944116,3.299086248751678,3.304788592451873,3.310472364919263,3.3161377550808,3.32178494897759,3.327414129824983,3.333025478071137,3.338619171454006,3.344195385056884,3.349754291362483,3.355296060305648,3.360820859324712,3.36632885341155,3.371820205160353,3.377295074815208,3.382753620316452,3.388195997345893,3.393622359370918,3.399032857687488,3.404427641462107,3.409806857772754,3.415170651648831,3.420519166110141,3.425852542204926,3.431170919047012,3.43647443385206,3.441763221972961,3.447037416934406,3.452297150466636,3.457542552538411,3.462773751389224,3.467990873560752,3.473194043927605,3.47838338572736,3.483559020589921,3.488721068566209,3.493869648156197,3.499004876336353,3.504126868586416,3.50923573891563,3.514331599888362,3.519414562649181,3.52448473694736,3.529542231160885,3.534587152319898,3.539619606129671,3.544639696993061,3.549647528032501,3.554643201111511,3.559626816855761,3.564598474673688,3.569558272776673,3.574506308198803,3.579442676816222,3.584367473366081,3.58928079146508,3.594182723627656,3.599073361283782,3.603952794796403,3.608821113478527,3.613678405609958,3.618524758453708,3.623360258272071,3.628184990342361,3.632999038972383,3.637802487515539,3.642595418385683,3.647377913071667,3.65215005215159,3.656911915306794,3.661663581335582,3.666405128166646,3.671136632872278,3.675858171681307,3.680569819991768,3.685271652383384,3.689963742629748,3.69464616371034,3.699318987822251,3.703982286391761,3.708636130085629,3.713280588822229,3.717915731782454,3.722541627420422,3.727158343473997,3.731765946975091,3.736364504259824,3.740954080978441,3.745534742105114,3.750106551947509,3.754669574156225,3.75922387173404,3.763769507045001,3.768306541823357,3.772835037182325,3.777355053622703,3.781866651041351,3.786369888739483,3.790864825430871,3.795351519249846,3.799830027759214,3.804300407958008,3.808762716289098,3.813217008646704,3.81766334038375,3.822101766319115,3.826532340744743,3.830955117432648,3.835370149641792,3.839777490124866,3.844177191134913,3.848569304431905,3.852953881289167,3.857330972499697,3.861700628382403,3.866062898788224,3.870417833106151,3.874765480269151,3.879105888760007,3.883439106617042,3.887765181439764,3.892084160394431,3.896396090219502,3.900701017231012,3.904998987327876,3.909290045997091,3.913574238318856,3.917851608971633,3.922122202237089,3.926386062005006,3.930643231778085,3.934893754676688,3.939137673443493,3.943375030448093,3.947605867691526,3.951830226810713,3.956048149082851,3.960259675429732,3.964464846421989,3.968663702283297,3.972856282894483,3.977042627797598,3.981222776199917,3.985396766977893,3.989564638681014,3.993726429535656,3.997882177448842,4.002031920011953,4.006175694504393,4.010313537897196,4.014445486856572,4.018571577747411,4.022691846636747,4.026806329297125,4.030915061210006,4.035018077569011,4.039115413283217,4.043207102980354,4.047293181009963,4.051373681446535,4.055448638092552,4.05951808448155,4.063582053881091,4.067640579295711,4.071693693469828,4.0757414288906,4.079783817790759,4.083820892151397,4.087852683704689,4.091879223936644,4.095900544089731,4.099916675165548,4.103927647927401,4.107933492902879,4.111934240386377,4.115929920441581,4.119920562903953,4.123906197383132,4.127886853265342,4.131862559715754,4.135833345680804,4.139799239890512,4.143760270860746,4.147716466895441,4.151667856088835,4.155614466327628,4.159556325293149,4.163493460463477,4.167425899115519,4.171353668327095,4.175276794978983,4.179195305756916,4.183109227153575,4.187018585470571,4.190923406820351,4.194823717128134,4.198719542133793,4.202610907393712,4.206497838282641,4.210380359995488,4.214258497549138,4.21813227578421,4.222001719366817,4.225866852790269,4.229727700376802,4.233584286279259,4.237436634482732,4.241284768806224,4.245128712904274,4.24896849026854,4.252804124229388,4.256635637957459,4.260463054465203,4.264286396608424,4.268105687087742,4.271920948450131,4.275732203090358,4.279539473252434,4.283342781031061,4.287142148373024,4.290937597078629,4.294729148803041,4.29851682505769,4.302300647211584,4.306080636492672,4.309856813989134,4.313629200650713,4.317397817289967,4.321162684583575,4.324923823073562,4.328681253168565,4.332434995145034,4.336185069148473,4.33993149519461,4.343674293170606,4.347413482836207,4.351149083824905,4.354881115645093,4.358609597681173,4.362334549194698,4.366055989325457,4.369773937092569,4.373488411395581,4.377199431015505,4.380907014615897,4.384611180743887,4.388311947831204,4.392009334195231,4.395703358039956,4.399394037457014,4.403081390426649,4.406765434818698,4.410446188393555,4.414123668803116,4.417797893591716,4.421468880197078,4.425136645951232,4.428801208081393,4.432462583710907,4.436120789860114,4.439775843447242,4.443427761289262,4.44707656010277,4.450722256504818,4.454364867013781,4.45800440805017,4.461640895937467,4.465274346902937,4.46890477707844,4.47253220250122,4.476156639114709,4.479778102769297,4.483396609223099,4.487012174142737,4.490624813104086,4.494234541593017,4.497841375006156,4.501445328651596,4.505046417749629,4.508644657433468,4.512240062749949,4.515832648660244,4.519422430040545,4.523009421682741,4.526593638295134,4.530175094503071,4.533753804849638,4.537329783796309,4.540903045723598,4.544473604931697,4.548041475641137,4.551606671993396,4.555169208051534,4.558729097800826,4.562286355149337,4.565840993928581,4.569393027894074,4.572942470725946,4.576489336029549,4.580033637336004,4.583575388102797,4.587114601714346,4.590651291482575,4.594185470647454,4.597717152377558,4.601246349770627,4.6047730758541,4.608297343585642,4.611819165853698,4.615338555477987,4.61885552521006,4.622370087733781,4.625882255665863,4.629392041556359,4.632899457889171,4.63640451708254,4.639907231489524,4.643407613398514,4.646905675033696,4.65040142855552,4.653894886061187,4.657386059585106,4.660874961099358,4.664361602514155,4.6678459956783,4.671328152379623,4.674808084345431,4.678285803242943,4.681761320679755,4.685234648204212,4.688705797305895,4.692174779416021,4.695641605907849,4.699106288097124,4.702568837242452,4.706029264545744,4.709487581152594,4.71294379815269,4.716397926580208,4.7198499774142,4.723299961578989,4.726747889944537,4.730193773326861,4.733637622488363,4.737079448138237,4.740519260932831,4.743957071476018,4.747392890319539,4.750826727963386,4.754258594856146,4.757688501395367,4.761116457927876,4.76454247475017,4.767966562108723,4.771388730200339,4.774808989172499,4.778227349123667,4.781643820103658,4.785058412113919,4.788471135107907,4.79188199899136,4.79529101362265,4.798698188813083,4.802103534327213,4.805507059883149,4.808908775152874,4.812308689762542,4.815706813292757,4.819103155278916,4.822497725211463,4.825890532536215,4.829281586654615,4.832670896924065,4.836058472658157,4.839444323127016,4.842828457557516,4.84621088513362,4.849591614996596,4.852970656245332,4.856348017936585,4.859723709085256,4.863097738664648,4.866470115606738,4.869840848802417,4.873209947101777,4.876577419314341,4.879943274209329,4.883307520515897,4.886670166923406,4.890031222081642,4.89339069460108,4.896748593053113,4.90010492597031,4.90345970184662,4.906812929137633,4.910164616260823,4.913514771595737,4.916863403484273,4.920210520230873,4.923556130102753,4.92690024133014,4.930242862106478,4.933584000588656,4.936923664897217,4.940261863116583,4.943598603295248,4.946933893446026,4.950267741546208,4.953600155537822,4.956931143327798,4.960260712788205,4.963588871756419,4.966915628035337,4.970240989393601,4.973564963565743,4.976887558252425,4.980208781120613,4.983528639803757,4.986847141902008,4.990164294982379,4.993480106578946,4.996794584193037,5.00010773529339,5.003419567316366,5.006730087666106,5.010039303714718,5.01334722280245,5.016653852237862,5.019959199298014,5.023263271228622,5.026566075244228,5.029867618528371,5.033167908233774,5.03646695148248,5.03976475536602,5.043061326945603,5.046356673252244,5.049650801286943,5.052943718020836,5.056235430395357,5.059525945322383,5.062815269684409,5.066103410334675,5.069390374097337,5.072676167767605,5.075960798111893,5.079244271867983,5.082526595745149,5.0858077764243,5.089087820558159,5.092366734771356,5.095644525660605,5.098921199794825,5.102196763715286,5.105471223935754,5.1087445869426,5.112016859194959,5.115288047124867,5.118558157137368,5.121827195610663,5.125095168896245,5.128362083319011,5.131627945177386,5.13489276074349,5.138156536263199,5.14141927795633,5.144680992016725,5.1479416846124,5.151201361885616,5.154460029953079,5.157717694905981,5.160974362810162,5.164230039706205,5.167484731609568,5.170738444510683,5.173991184375093,5.177242957143517,5.180493768732015,5.183743625032068,5.186992531910693,5.190240495210545,5.193487520750029,5.19673361432343,5.199978781700966,5.203223028628933,5.206466360829798,5.209708784002292,5.212950303821525,5.216190925939071,5.219430655983096,5.222669499558402,5.225907462246581,5.229144549606089,5.232380767172339,5.235616120457784,5.23885061495204,5.242084256121954,5.245317049411713,5.24854900024292,5.251780114014692,5.255010396103752,5.258239851864509,5.261468486629159,5.264696305707748,5.267923314388284,5.271149517936817,5.274374921597493,5.27759953059269,5.280823350123055,5.284046385367607,5.287268641483811,5.290490123607669,5.293710836853782,5.29693078631544,5.3001499770647,5.30336841415246,5.306586102608527,5.30980304744172,5.313019253639903,5.316234726170098,5.319449469978529,5.322663489990721,5.325876791111547,5.329089378225316,5.332301256195817,5.335512429866447,5.338722904060208,5.341932683579818,5.345141773207764,5.348350177706382,5.351557901817907,5.354764950264546,5.35797132774854,5.361177038952228,5.364382088538117,5.367586481148934,5.370790221407691,5.373993313917738,5.377195763262865,5.380397574007294,5.383598750695791,5.386799297853695,5.389999219987004,5.393198521582406,5.396397207107347,5.399595281010076,5.402792747719722,5.405989611646338,5.40918587718094,5.412381548695581,5.415576630543391,5.418771127058636,5.42196504255677,5.425158381334483,5.428351147669741,5.43154334582186,5.434734980031538,5.437926054520904,5.441116573493561,5.444306541134649,5.447495961610898,5.450684839070627,5.453873177643843,5.457060981442274,5.460248254559376,5.463435001070436,5.466621225032559,5.469806930484763,5.472992121447966,5.47617680192508,5.479360975901016,5.482544647342746,5.485727820199318,5.488910498401932,5.492092685863943,5.495274386480919,5.498455604130686,5.501636342673329,5.504816605951286,5.507996397789333,5.511175721994636,5.514354582356798,5.517532982647882,5.520710926622451,5.523888418017602,5.527065460552986,5.530242057930857,5.533418213836107,5.53659393193627,5.539769215881599,5.542944069305047,5.546118495822328,5.549292499031956,5.552466082515227,5.555639249836302,5.558812004542212,5.561984350162869,5.565156290211136,5.568327828182815,5.571498967556677,5.574669711794522,5.577840064341158,5.581010028624473,5.584179608055418,5.587348806028049,5.590517625919568,5.593686071090314,5.596854144883817,5.600021850626784,5.603189191629161,5.606356171184124,5.609522792568122,5.612689059040893,5.61585497384545,5.619020540208163,5.622185761338738,5.625350640430224,5.628515180659088,5.631679385185163,5.63484325715172,5.638006799685456,5.641170015896522,5.644332908878546,5.647495481708633,5.65065773744738,5.653819679138938,5.656981309810938,5.660142632474596,5.663303650124678,5.666464365739516,5.66962478228104,5.672784902694775,5.675944729909862,5.679104266839077,5.682263516378817,5.68542248140915,5.688581164793775,5.691739569380097,5.694897697999185,5.69805555346579,5.701213138578387,5.704370456119156,5.707527508853991,5.710684299532525,5.713840830888117,5.71699710563788,5.720153126482673,5.723308896107131,5.726464417179638,5.729619692352356,5.732774724261235,5.735929515526013,5.739084068750199,5.742238386521128,5.745392471409911,5.748546325971471,5.751699952744555,5.754853354251707,5.758006532999302,5.761159491477528,5.764312232160394,5.767464757505751,5.770617069955255,5.773769171934411,5.776921065852552,5.780072754102829,5.783224239062254,5.786375523091658,5.789526608535697,5.792677497722893,5.795828192965576,5.798978696559917,5.802129010785928,5.805279137907451,5.80842908017214,5.81157883981152,5.814728419040902,5.817877820059442,5.821027045050112,5.824176096179714,5.827324975598857,5.830473685441956,5.833622227827246,5.836770604856765,5.83991881861636,5.843066871175646,5.846214764588072,5.849362500890836,5.852510082104922,5.855657510235111,5.858804787269936,5.861951915181693,5.865098895926441,5.868245731443982,5.87139242365787,5.874538974475388,5.877685385787548,5.88083165946907,5.883977797378417,5.887123801357728,5.89026967323285,5.893415414813313,5.896561027892323,5.899706514246775,5.902851875637189,5.905997113807761,5.909142230486314,5.912287227384303,5.915432106196802,5.918576868602509,5.921721516263697,5.924866050826245,5.92801047391958,5.931154787156721,5.934298992134234,5.937443090432206,5.94058708361429,5.943730973227608,5.946874760802822,5.950018447854067,5.953162035878962,5.956305526358589,5.959448920757477,5.962592220523607,5.965735427088355,5.968878541866541,5.972021566256356,5.975164501639382,5.978307349380564,5.981450110828207,5.984592787313937,5.987735380152718,5.990877890642813,5.994020320065778,5.99716266968644,6.000304940752892,6.003447134496477,6.00658925213174,6.009731294856471,6.012873263851626,6.016015160281357,6.019156985292956,6.022298740016895,6.025440425566743,6.028582043039191,6.031723593514012,6.034865078054068,6.038006497705272,6.041147853496574,6.044289146439948,6.047430377530368,6.050571547745798,6.053712658047162,6.056853709378328,6.059994702666109,6.063135638820219,6.06627651873326,6.069417343280696,6.072558113320873,6.075698829694951,6.078839493226909,6.081980104723504,6.08512066497429,6.088261174751569,6.091401634810373,6.094542045888455,6.097682408706262,6.100822723966902,6.103962992356169,6.107103214542454,6.110243391176779,6.113383522892764,6.11652361030659,6.119663654017001,6.122803654605248,6.125943612635123,6.129083528652884,6.132223403187254,6.135363236749424,6.13850302983299,6.141642782913957,6.144782496450708,6.147922170883998,6.15106180663691,6.15420140411484,6.157340963705503,6.160480485778852,6.163619970687129,6.166759418764782,6.169898830328467,6.173038205677051,6.176177545091535,6.179316848835084,6.182456117152973,6.185595350272576,6.188734548403353,6.191873711736797,6.195012840446461,6.198151934687887,6.201290994598615,6.204430020298147,6.20756901188793,6.21070796945132,6.213846893053593,6.216985782741897,6.22012463854522,6.22326346047439,6.22640224852204,6.229541002662611,6.232679722852281,6.235818409029003,6.238957061112409,6.24209567900387,6.245234262586409,6.248372811724709,6.251511326265097,6.254649806035491,6.257788250845413,6.260926660485939,6.264065034729699,6.267203373330832,6.270341676024991,6.273479942529303,6.276618172542349,6.279756365744141,6.28289452179612};
PROGMEM const double exponential[] = {0.0,0.1438452159892324,0.2054671887997596,0.2535949069112423,0.2947510042542762,0.3314604585293627,0.3650174916848989,0.3961904988602843,0.4254798530194439,0.4532329216414832,0.4797024809700804,0.5050792512474963,0.5295113213421867,0.5531163935579373,0.5759898477809895,0.5982102472846835,0.6198432132132682,0.6409442221753633,0.6615606715761667,0.6817334341089579,0.7014980478065876,0.7208856409155037,0.7399236604061553,0.7586364527781259,0.7770457321818732,0.7951709614702955,0.813029665185728,0.8306376887723057,0.8480094148884445,0.8651579451874354,0.8820952540713012,0.8988323195228896,0.9153792350575847,0.9317453060201681,0.9479391328208322,0.9639686832112939,0.9798413553139691,0.9955640328095705,1.011143133442899,1.026584651809228,1.041894197224087,1.057077027349411,1.072138078142832,1.087081990609579,1.10191313476429,1.116635631150117,1.131253370212556,1.14577002978355,1.160189090896245,1.174513852120991,1.188747442588071,1.202892833841121,1.216952850646984,1.23093018087204,1.244827384521623,1.258646902027521,1.272391061858568,1.286062087520642,1.29966210400483,1.313193143735995,1.326657152068182,1.340055992368344,1.353391450725419,1.366665240317922,1.379879005469826,1.393034325421458,1.406132717839494,1.41917564208775,1.432164502278388,1.445100650121263,1.457985387587481,1.470819969401756,1.483605605376797,1.49634346260179,1.50903466749596,1.521680307737218,1.53428143407505,1.546839062036032,1.559354173529617,1.571827718361221,1.584260615659085,1.596653755220792,1.609007998784945,1.621324181232976,1.633603111725741,1.645845574779171,1.658052331282907,1.670224119465572,1.682361655810057,1.694465635921943,1.706536735353949,1.7185756103891,1.730582898785115,1.742559220482316,1.754505178277241,1.766421358463945,1.778308331444875,1.79016665231306,1.801996861407237,1.81379948484144,1.825575035010475,1.837324011072592,1.849046899410612,1.860744174072672,1.872416297193662,1.884063719398392,1.895686880187445,1.907286208306598,1.918862122100684,1.930415029852665,1.941945330108676,1.95345341198974,1.964939655490805,1.976404431767745,1.987848103412899,1.999271024719695,2.010673541936912,2.022055993513024,2.033418710331147,2.044762015934979,2.056086226746187,2.067391652273606,2.078678595314651,2.08994735214926,2.101198212726732,2.112431460845766,2.123647374327988,2.134846225185268,2.146028279781098,2.157193798986264,2.168343038329081,2.179476248140408,2.190593673693666,2.201695555340067,2.212782128639256,2.223853624485547,2.234910269229941,2.245952284798094,2.256979888804391,2.2679932946623,2.27899271169113,2.289978345219355,2.300950396684621,2.311909063730586,2.322854540300682,2.333787016728962,2.344706679828104,2.355613712974689,2.366508296191876,2.377390606229537,2.388260816641978,2.399119097863314,2.409965617280591,2.420800539304737,2.431624025439417,2.442436234347875,2.45323732191782,2.464027441324443,2.474806743091622,2.485575375151366,2.496333482901588,2.507081209262232,2.517818694729841,2.528546077430596,2.539263493171882,2.549971075492445,2.560668955711174,2.571357262974546,2.582036124302803,2.592705664634883,2.603366006872146,2.614017271920948,2.62465957873408,2.635293044351132,2.645917783937794,2.656533910824144,2.667141536541947,2.677740770860992,2.688331721824514,2.698914495783703,2.709489197431358,2.720055929834691,2.730614794467307,2.741165891240401,2.751709318533181,2.762245173222543,2.772773550712033,2.783294544960087,2.793808248507612,2.804314752504886,2.81481414673783,2.825306519653644,2.835791958385854,2.84627054877875,2.856742375411271,2.867207521620323,2.877666069523563,2.888118100041658,2.898563692920034,2.909002926750127,2.919435878990159,2.92986262598544,2.940283242988214,2.950697804177064,2.961106382675893,2.971509050572467,2.981905878936574,2.992296937837759,3.002682296362703,3.013062022632196,3.023436183817764,3.033804846157932,3.044168074974134,3.0545259346863,3.064878488828094,3.07522580006185,3.085567930193175,3.095904940185267,3.106236890172923,3.116563839476259,3.126885846614154,3.137202969317408,3.147515264541643,3.157822788479936,3.168125596575194,3.178423743532288,3.188717283329937,3.19900626923236,3.209290753800692,3.219570788904176,3.22984642573114,3.24011771479975,3.25038470596856,3.260647448446852,3.270905990804783,3.281160380983331,3.291410666304051,3.301656893478643,3.311899108618346,3.322137357243147,3.332371684290814,3.342602134125769,3.352828750547787,3.363051576800536,3.373270655579958,3.383486029042496,3.393697738813171,3.403905825993505,3.414110331169307,3.424311294418315,3.434508755317696,3.444702752951414,3.45489332591747,3.465080512335001,3.475264349851265,3.485444875648495,3.495622126450632,3.505796138529942,3.515966947713515,3.526134589389653,3.536299098514144,3.546460509616427,3.556618856805652,3.566774173776637,3.576926493815723,3.587075849806519,3.597222274235568,3.607365799197899,3.617506456402496,3.62764427717767,3.637779292476343,3.647911532881243,3.658041028610014,3.668167809520237,3.678291905114372,3.688413344544618,3.698532156617695,3.708648369799539,3.718762012219932,3.728873111677049,3.738981695641939,3.749087791262919,3.759191425369918,3.769292624478734,3.779391414795227,3.789487822219459,3.799581872349743,3.809673590486651,3.81976300163695,3.829850130517471,3.839935001558926,3.850017638909662,3.860098066439354,3.870176307742648,3.880252386142739,3.890326324694899,3.90039814618995,3.910467873157686,3.920535527870235,3.93060113234538,3.940664708349825,3.950726277402408,3.960785860777273,3.970843479506988,3.980899154385619,3.990952905971763,4.001004754591522,4.011054720341448,4.021102823091438,4.031149082487584,4.041193517954984,4.051236148700513,4.061276993715549,4.071316071778668,4.081353401458284,4.091389001115272,4.101422888905532,4.111455082782531,4.121485600499804,4.131514459613415,4.141541677484388,4.151567271281099,4.161591257981645,4.171613654376159,4.181634477069115,4.191653742481583,4.20167146685346,4.211687666245675,4.221702356542349,4.231715553452936,4.241727272514333,4.251737529092958,4.261746338386799,4.271753715427432,4.281759675082029,4.291764232055307,4.301767400891479,4.311769195976165,4.321769631538277,4.331768721651884,4.341766480238045,4.351762921066621,4.361758057758064,4.371751903785182,4.381744472474869,4.391735777009834,4.401725830430283,4.411714645635596,4.421702235385975,4.431688612304069,4.441673788876578,4.451657777455837,4.461640590261385,4.471622239381497,4.481602736774713,4.491582094271345,4.501560323574947,4.511537436263787,4.52151344379229,4.531488357492466,4.541462188575312,4.551434948132203,4.561406647136268,4.571377296443736,4.581346906795276,4.59131548881732,4.601283053023354,4.611249609815219,4.621215169484367,4.631179742213122,4.641143338075914,4.651105967040502,4.661067638969183,4.671028363619975,4.680988150647803,4.690947009605654,4.700904949945729,4.71086198102057,4.72081811208418,4.730773352293133,4.740727710707657,4.750681196292718,4.760633817919079,4.770585584364357,4.780536504314052,4.790486586362583,4.800435839014292,4.810384270684447,4.820331889700233,4.830278704301725,4.840224722642852,4.850169952792347,4.860114402734699,4.870058080371066,4.880000993520206,4.889943149919379,4.899884557225241,4.909825223014737,4.919765154785968,4.929704359959057,4.939642845877007,4.94958061980654,4.959517688938933,4.969454060390838,4.979389741205107,4.98932473835158,4.999259058727891,5.009192709160253,5.019125696404227,5.029058027145497,5.038989708000621,5.048920745517787,5.058851146177544,5.068780916393543,5.078710062513254,5.088638590818682,5.098566507527075,5.108493818791617,5.11842053070212,5.128346649285713,5.138272180507502,5.148197130271249,5.15812150442002,5.168045308736843,5.177968548945353,5.187891230710414,5.197813359638764,5.207734941279628,5.217655981125331,5.227576484611911,5.237496457119714,5.247415903973986,5.257334830445471,5.267253241750971,5.277171143053939,5.287088539465035,5.297005436042687,5.30692183779365,5.316837749673543,5.326753176587408,5.336668123390227,5.346582594887463,5.356496595835577,5.366410130942552,5.376323204868397,5.38623582222566,5.396147987579921,5.406059705450294,5.415970980309912,5.42588181658641,5.435792218662407,5.445702190875971,5.455611737521098,5.465520862848167,5.475429571064395,5.485337866334298,5.495245752780131,5.50515323448233,5.515060315479958,5.524966999771123,5.53487329131342,5.544779194024347,5.554684711781722,5.564589848424101,5.574494607751188,5.58439899352423,5.594303009466433,5.60420665926334,5.61410994656324,5.624012874977544,5.633915448081169,5.64381766941292,5.653719542475867,5.663621070737708,5.673522257631143,5.683423106554231,5.693323620870752,5.703223803910563,5.713123658969945,5.723023189311952,5.732922398166755,5.74282128873198,5.752719864173049,5.762618127623503,5.772516082185339,5.782413730929334,5.79231107689536,5.802208123092715,5.812104872500423,5.822001328067556,5.831897492713542,5.841793369328458,5.851688960773349,5.861584269880514,5.871479299453804,5.881374052268916,5.891268531073677,5.901162738588339,5.911056677505854,5.920950350492149,5.930843760186421,5.940736909201388,5.95062980012358,5.960522435513592,5.970414817906357,5.980306949811405,5.99019883371313,6.000090472071033,6.009981867319988,6.019873021870487,6.029763938108894,6.039654618397687,6.049545065075701,6.059435280458372,6.069325266837974,6.079215026483852,6.089104561642665,6.0989938745386,6.108882967373621,6.118771842327678,6.128660501558937,6.138548947204009,6.148437181378156,6.158325206175512,6.168213023669306,6.17810063591206,6.187988044935811,6.197875252752316,6.20776226135325,6.217649072710418,6.227535688775959,6.237422111482529,6.247308342743523,6.257194384453243,6.267080238487112,6.27696590670186,6.286851390935704,6.296736693008548,6.306621814722154,6.316506757860344,6.326391524189163,6.336276115457069,6.346160533395109,6.356044779717092,6.365928856119761,6.375812764282979,6.385696505869879,6.395580082527047,6.405463495884686,6.415346747556777,6.425229839141248,6.435112772220132,6.444995548359725,6.454878169110755,6.464760636008521,6.474642950573068,6.48452511430933,6.494407128707276,6.504288995242073,6.514170715374232,6.524052290549747,6.533933722200251,6.543815011743152,6.553696160581783,6.563577170105542,6.573458041690025,6.583338776697175,6.59321937647541,6.603099842359764,6.612980175672022,6.622860377720847,6.632740449801918,6.642620393198055,6.652500209179354,6.662379899003308,6.672259463914938,6.682138905146915,6.692018223919687,6.701897421441595,6.711776498909003,6.721655457506415,6.731534298406585,6.741413022770647,6.751291631748225,6.761170126477549,6.771048508085571,6.780926777688072,6.79080493638978,6.80068298528448,6.810560925455118,6.820438757973914,6.830316483902468,6.840194104291865,6.850071620182786,6.8599490326056,6.869826342580479,6.87970355111749,6.889580659216707,6.899457667868298,6.909334578052635,6.919211390740382,6.929088106892603,6.938964727460845,6.948841253387244,6.958717685604612,6.968594025036532,6.978470272597453,6.988346429192773,6.998222495718939,7.008098473063531,7.017974362105347,7.0278501637145,7.037725878752493,7.047601508072316,7.057477052518522,7.067352512927315,7.077227890126633,7.08710318493623,7.096978398167754,7.106853530624836,7.11672858310316,7.126603556390546,7.136478451267037,7.146353268504958,7.15622800886901,7.166102673116332,7.175977261996588,7.185851776252036,7.1957262166176,7.205600583820945,7.215474878582549,7.225349101615773,7.235223253626936,7.245097335315378,7.254971347373536,7.264845290487007,7.274719165334621,7.284592972588505,7.294466712914151,7.304340386970478,7.314213995409904,7.324087538878405,7.333961018015582,7.343834433454725,7.353707785822867,7.363581075740859,7.373454303823424,7.383327470679217,7.393200576910889,7.403073623115142,7.412946609882792,7.42281953779883,7.432692407442468,7.44256521938721,7.452437974200898,7.462310672445776,7.472183314678542,7.482055901450401,7.491928433307124,7.501800910789098,7.511673334431377,7.521545704763746,7.53141802231076,7.541290287591804,7.551162501121141,7.561034663407961,7.570906774956438,7.580778836265774,7.590650847830245,7.600522810139261,7.610394723677403,7.620266588924476,7.630138406355559,7.64001017644104,7.649881899646678,7.659753576433641,7.669625207258547,7.67949679257352,7.689368332826222,7.699239828459907,7.709111279913465,7.718982687621452,7.72885405201415,7.738725373517596,7.748596652553633,7.758467889539947,7.768339084890107,7.77821023901361,7.788081352315918,7.797952425198496,7.807823458058859,7.817694451290603,7.827565405283448,7.837436320423275,7.847307197092163,7.85717803566843,7.867048836526669,7.876919600037779,7.88679032656901,7.896661016483995,7.906531670142782,7.916402287901882,7.926272870114285,7.936143417129511,7.94601392929364,7.955884406949339,7.965754850435907,7.975625260089296,7.985495636242153,7.995365979223854,8.005236289360525,8.015106566975087,8.024976812387282,8.034847025913695,8.044717207867812,8.054587358560017,8.064457478297644,8.074327567385003,8.084197626123412,8.094067654811216,8.103937653743825,8.113807623213749,8.12367756351061,8.133547474921182,8.143417357729419,8.153287212216478,8.163157038660753,8.173026837337893,8.182896608520837,8.19276635247984,8.202636069482496,8.212505759793762,8.222375423675992,8.232245061388962,8.242114673189885,8.251984259333446,8.261853820071824,8.271723355654714,8.281592866329367,8.291462352340583,8.301331813930762,8.311201251339925,8.321070664805724,8.330940054563476,8.34080942084618,8.350678763884547,8.360548083907018,8.370417381139784,8.380286655806813,8.39015590812987,8.40002513832854,8.409894346620243,8.419763533220264,8.429632698341772,8.439501842195838,8.449370964991456,8.459240066935564,8.469109148233066,8.478978209086852,8.488847249697814,8.49871627026487,8.508585270984979,8.518454252053168,8.528323213662542,8.538192156004309,8.548061079267793,8.557929983640463,8.56779886930794,8.577667736454016,8.587536585260686,8.597405415908145,8.607274228574823,8.617143023437393,8.627011800670788,8.636880560448228,8.646749302941224,8.656618028319599,8.666486736751517,8.676355428403474,8.686224103440338,8.696092762025359,8.705961404320167,8.715830030484824,8.725698640677802,8.73556723505602,8.745435813774858,8.755304376988162,8.76517292484827,8.775041457506022,8.784909975110773,8.794778477810413,8.804646965751374,8.814515439078653,8.824383897935817,8.834252342465026,8.84412077280704,8.853989189101236,8.863857591485623,8.873725980096848,8.883594355070224,8.89346271653972,8.903331064638003,8.913199399496426,8.923067721245056,8.932936030012682,8.942804325926817,8.952672609113737,8.962540879698468,8.972409137804803,8.982277383555326,8.992145617071413,9.002013838473246,9.01188204787983,9.021750245408995,9.031618431177417,9.041486605300625,9.051354767893008,9.061222919067838,9.071091058937268,9.080959187612349,9.090827305203046,9.10069541181824,9.11056350756574,9.120431592552297,9.130299666883614,9.140167730664356,9.150035783998156,9.159903826987632,9.169771859734391,9.179639882339044,9.189507894901213,9.19937589751954,9.209243890291697,9.219111873314397,9.228979846683401,9.238847810493535,9.248715764838684,9.258583709811823,9.268451645505,9.278319572009364,9.288187489415172,9.29805539781179,9.307923297287708,9.317791187930544,9.327659069827057,9.337526943063153,9.347394807723893,9.357262663893506,9.36713051165539,9.376998351092123,9.386866182285473,9.396734005316407,9.406601820265092,9.416469627210912,9.426337426232465,9.43620521740758,9.446073000813325,9.455940776526006,9.465808544621185,9.47567630517367,9.485544058257545,9.495411803946164,9.505279542312156,9.515147273427443,9.525014997363234,9.534882714190042,9.544750423977687,9.554618126795303,9.564485822711344,9.574353511793595,9.584221194109167,9.59408886972452,9.603956538705456,9.613824201117135,9.623691857024072,9.63355950649015,9.643427149578628,9.653294786352138,9.663162416872701,9.673030041201729,9.682897659400025,9.692765271527797,9.702632877644668,9.712500477809668,9.722368072081249,9.73223566051729,9.7421032431751,9.751970820111428,9.76183839138246,9.771705957043835,9.781573517150647,9.791441071757442,9.801308620918233,9.811176164686504,9.821043703115214,9.830911236256805,9.840778764163192,9.850646286885791,9.86051380447551,9.870381316982757,9.880248824457444,9.890116326948991,9.89998382450634,9.90985131717794,9.919718805011774,9.929586288055358,9.939453766355724,9.949321239959456,9.959188708912677,9.969056173261057,9.978923633049817,9.988791088323733,9.998658539127142,10.00852598550394,10.01839342749761,10.02826086515119,10.0381282985073,10.04799572760814,10.05786315249549,10.06773057321075,10.07759798979487,10.08746540228842,10.09733281073158,10.10720021516412,10.11706761562542,10.12693501215448,10.13680240478993,10.14666979356998,10.15653717853251,10.166404559715,10.17627193715457,10.18613931088797,10.19600668095161,10.20587404738151,10.21574141021337,10.2256087694825,10.23547612522391,10.24534347747222,10.25521082626175,10.26507817162646,10.27494551359997,10.28481285221559,10.29468018750629,10.30454751950473,10.31441484824323,10.32428217375381,10.33414949606815,10.34401681521766,10.3538841312334,10.36375144414615,10.37361875398638,10.38348606078426,10.39335336456966,10.40322066537217,10.41308796322108,10.42295525814539,10.43282255017382,10.44268983933481,10.45255712565651,10.46242440916681,10.4722916898933,10.48215896786334,10.49202624310397,10.50189351564201,10.511760785504,10.52162805271621,10.53149531730466,10.54136257929512,10.55122983871309,10.56109709558384,10.57096434993238,10.58083160178347,10.59069885116165,10.60056609809118,10.61043334259613,10.62030058470029,10.63016782442724,10.64003506180032,10.64990229684264,10.6597695295771,10.66963676002636,10.67950398821284,10.68937121415878,10.69923843788618,10.70910565941681,10.71897287877225,10.72884009597386,10.73870731104279,10.74857452399997,10.75844173486615,10.76830894366186,10.77817615040742,10.78804335512297,10.79791055782844,10.80777775854358,10.81764495728792,10.82751215408081,10.83737934894141,10.84724654188871,10.85711373294149,10.86698092211834,};

float val[MAX];

void setup() {
  pinMode(ENABLE, OUTPUT); // enable
  pinMode(STEPY, OUTPUT); // stepY
  pinMode(DIRY, OUTPUT); // dirY
  digitalWrite(ENABLE, LOW);
 Serial.begin(115200);
}


double* espTime;

int MAX2=1000;
const float PI2=PI*PI;
float at=PI*PI/MAX2; // 9.867
 
float solve(float t) { // will return the interpolated time (0..2*PI) that corresponds to a given distance (0 .. PI^2) according to espTime table
 if(t>=PI2) return pgm_read_float_near(espTime+MAX2-1); 
 int n=(t/at); //Serial.print("n="); Serial.println(n);
 float dt=t-n*at;
 if(dt==0) return pgm_read_float_near(espTime+n);
 return (pgm_read_float_near(espTime+n+1)-pgm_read_float_near(espTime+n))*dt/at+pgm_read_float_near(espTime+n);
}



const int N=MAX;
float a=10;

void loop() {
  // linear values step n happens after n-1 as sqrt(2n/a)-sqrt(2*(n-1)/a)
  for(int i=1; i<MAX; i++) val[i]=sqrt(2*i/a/MAX)-sqrt(2*(i>0?i-1:0)/a/MAX); 
  test_val(); 
  // s-curve t^3/25, step happens
  for(int i=1; i<MAX; i++) val[i]=(pow(25*i/a/MAX,1.0/3)-pow(25*(i>0?i-1:0)/a/MAX,1.0/3))*.5;
  test_val();
  // exponential acceleration
  espTime=exponential;
  for(int i=1; i<MAX; i++) val[i]=(solve(3.27*i/MAX)-solve(3.27*(i>0?i-1:0)/MAX))*0.1;
  test_val();
  // sinusoidal s-curve
  espTime=senoidal;
  for(int i=1; i<MAX; i++) val[i]=(solve(9.867*i/MAX)-solve(9.867*(i>0?i-1:0)/MAX))*0.08;
  test_val();
  // invert direction for next round
  digitalWrite(DIRY,1-digitalRead(DIRY)); 
  
}

void test_val() {
  for(int i=1; i<MAX; i++) {
    delayMicroseconds(val[i]*1e6); // delay is the time difference between values
    digitalWrite(STEPY, HIGH);
    //delayMicroseconds(2);
    digitalWrite(STEPY, LOW);
  }
  for(int i=MAX-1; i>0; i--) {
    delayMicroseconds(val[i]*1e6); // delay is the time difference between values
    digitalWrite(STEPY, HIGH);
    //delayMicroseconds(2);
    digitalWrite(STEPY, LOW);
  }
  delay(1000);
}

